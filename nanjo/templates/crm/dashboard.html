{% extends 'base.html' %} {% block content %}
<h2 class="mt-2 mb-3 md:text-4xl font-extrabold text-center text-gray-800">CRM Dashboard</h2>
<div class="row mb-4">
  <div class="col-md-4">
    <div class="card text-bg-primary mb-3">
      <div class="card-body">
        <h6 class="card-title">Customers</h6>
        <div class="display-6">{{ total_customers }}</div>
      </div>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card text-bg-warning mb-3">
      <div class="card-body">
        <h6 class="card-title">Active Orders</h6>
        <div class="display-6">{{ active_orders }}</div>
      </div>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card text-bg-light mb-3">
      <div class="card-body">
        <h6 class="card-title">Status Breakdown</h6>
        <ul class="mb-0">
          {% for row in status_counts %}
          <li>{{ row.status }}: {{ row.total }}</li>
          {% empty %}
          <li>No orders yet</li>
          {% endfor %}
        </ul>
      </div>
    </div>
  </div>
</div>

<h4>Recent Orders</h4>
<div class="table-responsive">
  <table class="table table-striped">
    <thead>
      <tr>
        <th>Customer</th>
        <th>Service</th>
        <th>Status</th>
        <th>Created</th>
      </tr>
    </thead>
    <tbody>
      {% for order in recent_orders %}
      <tr>
        <td>{{ order.customer.name }}</td>
        <td>{{ order.get_service_type_display }}</td>
        <td>{{ order.get_status_display }}</td>
        <td>{{ order.created_at|date:"Y-m-d H:i" }}</td>
      </tr>
      {% empty %}
      <tr>
        <td colspan="4">No orders yet.</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
